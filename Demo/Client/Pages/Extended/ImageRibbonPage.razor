@page "/documentation/extended/imageribbon"

<DocumentationRoot>
    <ExampleBox>
        <ExampleOptions>
            <EditForm Model="@this">
                <DataAnnotationsValidator />
                <ValidationSummary />

                <OptionsBox>
                    <OptionsBoxItem>
                        <SchemeColorSelect Label="Color" @bind-Value="Color" />
                    </OptionsBoxItem>

                    <OptionsBoxItem>
                        <RatioSelect Label="Ratio"                    
                            Value="Ratio"
                            ValueChanged="@((value) => ValueChangedHandler(value))" />
                    </OptionsBoxItem>

                    <OptionsBoxItem>
                        <label class="label">Display Count</label>
                        <BulInputNumber @bind-Value="DisplayCount" />
                    </OptionsBoxItem>

                    <OptionsBoxItem>
                        <label class="label">Focused Index</label>
                        <BulSlider @bind-Value="FocusedIndex" Min="0" Max="(DemoEntries.Length - 1)" Step="1" />
                    </OptionsBoxItem>
                </OptionsBox>
            </EditForm>
        </ExampleOptions>

        <ExampleResult>
            <div>Selected: @(FocusedIndex + 1) / @DemoEntries.Length</div>
            <BulImageRibbon @bind-Value="FocusedIndex" 
                style="min-height: 200px;"
                Images="DemoEntries" 
                DisplayCount="DisplayCount" 
                Color="Color" 
                Ratio="Ratio" 
            />
        </ExampleResult>
    </ExampleBox>

    <div class="columns">
        <div class="column is-half">
            <BulMessage>
                <BulMessageHeader>Note</BulMessageHeader>
                <BulMessageBody>
                    You must provide a height greater than any content to prevent 
                    bobbing while scrolling through items.
                </BulMessageBody>
            </BulMessage>
        </div>
    </div>

</DocumentationRoot>

@code {
    public BulSchemeColor? Color { get; set; }
    public BulRatio? Ratio { get; set; }
    public int DisplayCount { get; set; } = 5;
    public int FocusedIndex { get; set; } = 1;
    public Uri[] DemoEntries { get; set; } = new Uri[12];

    protected override void OnInitialized()
    {
        BuildImages(null);
    }

    private void ValueChangedHandler(BulRatio? value)
    {
        Ratio = value;

        if(value.HasValue)
            Console.WriteLine($"huh... {value.Value}");

        BuildImages(value);
    }

    private void BuildImages(BulRatio? ratio)
    {
        string size  = "480x480";

        if(ratio.HasValue)
        {
            switch (ratio.Value)
            {
                case BulRatio.RSquare:
                    size  = "480x480";
                    break;
                case BulRatio.R1by1:
                    size  = "480x480";
                    break;
                case BulRatio.R5by4:
                    size  = "600x480";
                    break;
                case BulRatio.R4by3:
                    size  = "640x480";
                    break;
                case BulRatio.R3by2:
                    size  = "480x320";
                    break;
                case BulRatio.R5by3:
                    size  = "800x480";
                    break;
                case BulRatio.R16by9:
                    size  = "640x360";
                    break;
                case BulRatio.R2by1:
                    size  = "640x320";
                    break;
                case BulRatio.R3by1:
                    size  = "720x240";
                    break;
                case BulRatio.R4by5:
                    size  = "480x600";
                    break;
                case BulRatio.R3by4:
                    size  = "480x640";
                    break;
                case BulRatio.R2by3:
                    size  = "320x480";
                    break;
                case BulRatio.R3by5:
                    size  = "480x800";
                    break;
                case BulRatio.R9by16:
                    size  = "360x640";
                    break;
                case BulRatio.R1by2:
                    size  = "320x640";
                    break;
                case BulRatio.R1by3:
                    size  = "240x720";
                    break;
            }
        }

        for (int i = 0; i < DemoEntries.Length; i++)
        {
            DemoEntries[i] = new Uri($"https://bulma.io/images/placeholders/{size}.png");
            //var s = (i + 1).ToString("00");
            //DemoEntries[i] = new Uri($"https://localhost:5001/images/zelda-{s}.jpg");
        }
    }
}